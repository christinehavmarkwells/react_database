<!doctype html>
<html>
    <head>
        <title>Inl√§mningsuppgift 5</title>
        <meta charset="utf-8">
        <script src="js/react.min.js"></script>
        <script src="js/react-dom.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
        <link rel="stylesheet" href="css/styles.css" />
    </head>
    <body>

        <div id="root"></div>

        <script type="text/babel">

            var yogaPoses = [
                { name: "Shavasana", level: "1", type: "Resting pose" },
                { name: "Pigeon", level: "2", type: "Hip opener" },
                { name: "Dancer", level: "3", type: "Hip and chest opener" }
            ];

            var YogaPose = React.createClass({

                render: function() {
                    return (
                        <div>
                            <p>Name: {this.props.yogaPose.name}
                                <br/>
                                Level: {this.props.yogaPose.level}
                                <br/>
                                Type: {this.props.yogaPose.type}</p>
                            <button id="editButton" onClick={this.props.onClick} type="button">Edit this pose</button>
                            <button id="removeButton" onClick={this.props.onClick} type="button">Remove this pose</button>
                        </div>   
                    )
                }

            });

            var AddYogaPose = React.createClass({

                getInitialState: function() {

                    return {
                        yogaPoses: yogaPoses
                    };

                },

                render: function() {

                    return (
                        <form onSubmit={this.handleSubmit}>
                            <h4>Add a yoga pose to the database</h4>
                            <label htmlFor="addedPoseName">Name of yoga pose</label >
                            <br/>
                            <input id="addedPoseName" value={this.state.name} onChange={this.handleChange} />
                            <br/>
                            <label htmlFor="addedPoseLevel">Level of difficulty</label>
                            <br/>
                            <input id="addedPoseLevel" value={this.state.level} onChange={this.handleChange}/>
                            <br/>
                            <label htmlFor="addedPoseType">Type of pose</label>
                            <br/>
                            <input id="addedPoseType" value={this.state.type} onChange={this.handleChange}/>
                            <br/>
                            <button onClick={this.props.onClick} type="button">Add pose</button>
                        </form>
                        // <form onSubmit={this.handleSubmit}>
                        //     <h4>Add a yoga pose to the database</h4>
                        //     <label htmlFor="addedPoseName">Name of yoga pose</label >
                        //     <br/>
                        //     <input id="addedPoseName" ref="id" type="text" onChange={this.state.addClick} />
                        //     <br/>
                        //     <label htmlFor="addedPoseLevel">Level of difficulty</label>
                        //     <br/>
                        //     <input id="addedPoseLevel" ref="id" type="text" onChange={this.state.addClick}/>
                        //     <br/>
                        //     <label htmlFor="addedPoseType">Type of pose</label>
                        //     <br/>
                        //     <input id="addedPoseType" ref="id" type="text" onChange={this.state.addClick}/>
                        //     <br/>
                        //     <button onClick={this.props.onClick} type="button">Add pose</button>
                        // </form>
                    )
                }

            });

            var YogaPoseList = React.createClass({

                getInitialState: function() {

                    // this.addClick = this.addClick.bind(this);
                    // this.handleSubmit = this.handleSubmit.bind(this);  

                    return {
                        yogaPoses: yogaPoses
                    };
                },

                removeClick: function(index) {

                    console.log("test: remove");

                    this.state.yogaPoses.splice(index, 1);
                    this.setState({
                        yogaPoses: this.state.yogaPoses
                    });

                },

                // changeClick: function(index) {
                //     this.state.yogaPoses.splice(index, 1);
                //     this.setState({
                //         yogaPoses: this.state.yogaPoses
                //     });
                // },

                addClick: function(event) {

                    console.log("test: add");
                    console.log(yogaPoses);
                    console.log(this.state.name.value);
                    
                    var newItem = {
                        name: this.state.name.value,
                        level: this.state.level.value,
                        type: this.state.type.value
                    }
                    
                    this.state.yogaPoses.push(newItem);
                    this.setState({
                        yogaPoses: this.state.yogaPoses
                    });

                },

                handleChange: function(event) {

                    console.log("test: change");

                    this.setState({
                        name: event.target.value,
                        level: event.target.value,
                        type: event.target.value
                    });
                },

                handleSubmit: function(event) {

                    console.log("test: submit");

                    event.preventDefault();
                    this.setState({
                        yogaPoses: state.yogaPoses.concat(yogaPose),
                        name: event.target.value
                    });
                },

                render: function() {

                    return (
                        <div>
                            <h2>Yoga pose database</h2>
                            <ul>
                                {this.state.yogaPoses.map(function(yogaPose, index) {
                                    return (
                                        <YogaPose
                                            yogaPose={yogaPose}
                                            onClick={this.removeClick.bind(this, index)}  
                                        />
                                    )
                                }, this)}
                            </ul>
                            <AddYogaPose 
                            onSubmit={this.handleSubmit.bind(this)}
                            onChange={this.handleChange.bind(this)}
                            onClick={this.addClick.bind(this)}
                            />
                        </div>
                    )

                }

            });

            ReactDOM.render(

                <YogaPoseList />,
                document.getElementById("root")

            );

        </script>
    </body>
</html>
